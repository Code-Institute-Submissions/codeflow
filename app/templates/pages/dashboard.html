{% extends 'layout/base.html' %}
{% block content %}


<div class="container mt-5">

    <section class="section-content">
        <legend class="text-center border-bottom my-auto">{{ session['username'] }}'s Dashboard</legend>
        {% if profile %}
        <p class="text-center">Last updated: {{ profile.date }} </p>
        {% endif %}
        <div class="row">
            <div class="col-sm-12 col-md-4 mb-2  mt-2 text-center my-auto">
                <a class="btn btn-outline-primary btn-sm" type="button" id="update-image-btn" href="#">Update
                    Image</a>
            </div>
            <div class="col-sm-12 col-md-4 mb-2 mt-2" id="div-profile-image">
                <img id="dashboard-profile-image" src="{{ url_for('static', filename='images/gear-avatar.png') }}"
                    alt="user-profile-image" width="60" height="60">
            </div>
            <div class="col-sm-12 col-md-4 mb-2 text-center my-auto">
                <a class="btn btn-outline-primary btn-sm" type="button" id="update-password-btn"
                    href="{{ url_for('update_password') }}">Update
                    Password</a>
            </div>
        </div>
        <div class="row section-content">
            {% if profile %}
            <div class="row">
                <div class="col-12 mb-2 text-center ">
                    <a class="btn btn-outline-primary btn-sm" type="button" id="update-profile-btn"
                        href="{{ url_for('edit_profile', profile_id=profile._id) }}">Update
                        Profile</a>
                    <!-- Button to trigger modal for confirmation of delete request -->
                    <button class="btn btn-outline-danger btn-sm" type="button" id="delete-profile-modal"
                        data-toggle="modal" data-target="#deleteProfile">Delete Profile
                    </button>
                    <!-- Modal -->
                    <div class="modal fade" id="deleteProfile" role="dialog">
                        <div class="modal-dialog">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title" style="color:red;">WARNING</h4>
                                </div>
                                <div class="modal-body">
                                    <p>This process is immediate and cannot be undone. Are you sure?</p>
                                    <!-- Button to confirm delete article -->
                                    <form action="{{ url_for('delete_profile', profile_id=profile._id) }}"
                                        method="post">
                                        <input id="delete-profile-btn" class="btn btn-outline-success btn-sm"
                                            type="submit" value="Confirm Delete">
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-outline-danger btn-sm"
                                        data-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 dashboard-profile">
                    <div class="profile">
                        <div>
                            <table style="width:100%">
                                <tr>
                                    <th>Headline:</th>
                                    <td> {{ profile.headline }}</td>
                                </tr>

                            </table>
                            <table style="width:100%">
                                <tr>
                                    <th>Bio:</th>
                                    <td>{{ profile.bio|safe }}</td>
                                </tr>
                            </table>
                        </div>
                        <div>
                            <table width="100%">
                                <tr>
                                    <th>Languages:</th>
                                    {% for lang in profile.languages %}
                                    <td>{{ lang }}</td>
                                    {% endfor %}
                                </tr>
                            </table>
                            <table width="100%">
                                <tr>
                                    <th>Frameworks:</th>
                                    {% for item in profile.frameworks %}
                                    <td>{{ item }}</td>
                                    {% endfor %}
                                </tr>
                            </table>
                            <table width="100%">
                                <tr>
                                    <th>Personal Links:</th>
                                    {% for link in profile.personal_links %}
                                    {% for key, value in link.items() %}
                                    <td>{{ key }}: {{ value }}</td>
                                    {% endfor %}
                                    {% endfor %}
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-sm-12 text-center mb-2">
            <button class="btn btn-outline-primary btn-sm" type="submit" id="add-profile"><a
                    href="{{ url_for('add_profile')}}"></a>
                Add Profile</button>
        </div>
        <div class="col-sm-12 text-center">
            <p>If you create a profile it will appear here.</p>
        </div>
        {% endif %}
</div>
</section>
</div>

{% endblock content %}